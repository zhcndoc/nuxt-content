import{F as t,G as e,H as s,I as o,J as a,K as r,L as n,M as d,N as i,O as l,P as p,Q as u,c,R as h,S as y,T as f,U as m,V as g,W as _,X as b,Y as x,Z as j,_ as C,a0 as T,j as w,a1 as A,a2 as k,a3 as P,a4 as R,a5 as $}from"../nitro/nitro.mjs";import"node:buffer";import"node:events";import"node:process";import"node:timers";import"node:async_hooks";import"cloudflare:workers";import"node:path";function renderPayloadJsonScript(t){const e={type:"application/json",innerHTML:t.data?s(t.data,t.ssrContext._payloadReducers):"","data-nuxt-data":a,"data-ssr":!t.ssrContext.noSSR,id:"__NUXT_DATA__"};t.src&&(e["data-src"]=t.src);return[e,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${o(t.ssrContext.config)}`}]}function splitPayload(t){const{data:e,prerenderedAt:s,...o}=t.payload;return{initial:{...o,prerenderedAt:s},payload:{data:e,prerenderedAt:s}}}const S={omitLineBreaks:!0};globalThis.__buildAssetsURL=n,globalThis.__publicAssetsURL=d;const v=!!p.id,L=v?`<${i}${l(p)}>`:"",N=v?`</${i}>`:"",M=/^[^?]*\/_payload.json(?:\?.*)?$/;let O;const U=r(async o=>{const a=$(),r=o.path.startsWith("/__nuxt_error")?u(o):null;if(r&&!("__unenv__"in o.node.req))throw c({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const d=h(o),i={mode:"server"};if(d.head.push(y,i),r){if(r.statusCode&&=Number.parseInt(r.statusCode),"string"==typeof r.data)try{r.data=f(r.data)}catch{}m(d,r)}const l=M.test(d.url);if(l){const t=d.url.substring(0,d.url.lastIndexOf("/"))||"/";d.url=t,o._path=o.node.req.url=t}const U=g(o);!1===U.ssr&&(d.noSSR=!0);const H=await _(d);for(const t of await b())d.modules.add(t);const I=await H.renderToString(d).catch(async t=>{if(d._renderResponse&&"skipping render"===t.message)return{};const e=!r&&d.payload?.error||t;throw await(d.nuxt?.hooks.callHook("app:error",e)),e}),J=d._renderResponse||l?[]:await x(d.modules??[]);if(await(d.nuxt?.hooks.callHook("app:rendered",{ssrContext:d,renderResult:I})),d._renderResponse)return d._renderResponse;if(d.payload?.error&&!r)throw d.payload.error;if(l){const o=function(o){return{body:s(splitPayload(o).payload,o._payloadReducers),statusCode:e(o.event),statusMessage:t(o.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(d);return o}const X=U.noScripts,{styles:z,scripts:Y}=j(d,H.rendererContext);if(!X){let t=O;t||(t=n("YjgZfOnZ.js"),/^(?:\/|\.+\/)/.test(t)||C(t,{acceptRelative:!0})?O=t:(t=T(o.path.replace(/\/[^/]+$/,"/"),w("/",t)),/^(?:\/|\.+\/)/.test(t)||(t=`./${t}`))),d.head.push({script:[{tagPosition:"head",tagPriority:-2,type:"importmap",innerHTML:JSON.stringify({imports:{"#entry":t}})}]},i)}d._preloadManifest&&!X&&d.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:n(`builds/meta/${d.runtimeConfig.app.buildId}.json`)}]},{...i,tagPriority:"low"}),J.length&&d.head.push({style:J});const Z=[];for(const t of Object.values(z))Z.push({rel:"stylesheet",href:H.rendererContext.buildAssetsURL(t.file),crossorigin:""});if(Z.length&&d.head.push({link:Z},i),X||(d.head.push({link:A(d,H.rendererContext)},i),d.head.push({link:k(d,H.rendererContext)},i),d.head.push({script:renderPayloadJsonScript({ssrContext:d,data:d.payload})},{...i,tagPosition:"bodyClose",tagPriority:"high"})),!U.noScripts){const t="head";d.head.push({script:Object.values(Y).map(e=>({type:e.module?"module":null,src:H.rendererContext.buildAssetsURL(e.file),defer:!e.module||null,tagPosition:t,crossorigin:""}))},i)}const{headTags:q,bodyTags:B,bodyTagsOpen:D,htmlAttrs:F,bodyAttrs:W}=await P(d.head,S),E={htmlAttrs:F?[F]:[],head:normalizeChunks([q]),bodyAttrs:W?[W]:[],bodyPrepend:normalizeChunks([D,d.teleports?.body]),body:[R(d,I.html),L+(v?joinTags([d.teleports?.[`#${p.id}`]]):"")+N],bodyAppend:[B]};return await a.hooks.callHook("render:html",E,{event:o}),{body:(G=E,`<!DOCTYPE html><html${joinAttrs(G.htmlAttrs)}><head>${joinTags(G.head)}</head><body${joinAttrs(G.bodyAttrs)}>${joinTags(G.bodyPrepend)}${joinTags(G.body)}${joinTags(G.bodyAppend)}</body></html>`),statusCode:e(o),statusMessage:t(o),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var G});function normalizeChunks(t){return t.filter(Boolean).map(t=>t.trim())}function joinTags(t){return t.join("")}function joinAttrs(t){return 0===t.length?"":" "+t.join(" ")}export{U as default};
//# sourceMappingURL=renderer.mjs.map
